<!DOCTYPE html><meta charset=utf8><meta name=viewport content="width=device-width, user-scalable=0"><meta name=apple-mobile-web-app-capable content=yes><meta name=theme-color content=#000><title>GoodLuck (opt)</title><style>body,html{margin:0;overflow:hidden}canvas,main{height:100vh;overflow:hidden;position:absolute;touch-action:none;user-select:none;width:100vw;word-break:break-word}[onclick]{cursor:pointer}</style><canvas id=scene></canvas><canvas id=billboard></canvas><main></main><script>(()=>{function t(t,i){let e=t.i.t();for(let n of i)n(t,e);return e}function i(t,i,e){let n=t.createShader(i);return t.shaderSource(n,e),t.compileShader(n),n}function e(t,i,e){let n=i[0],s=i[1],o=i[2],r=i[3],h=i[4],c=i[5],u=i[6],a=i[7],l=i[8],f=i[9],d=i[10],v=i[11],p=i[12],m=i[13],w=i[14],_=i[15],M=e[0],x=e[1],T=e[2],y=e[3];return t[0]=M*n+x*h+T*l+y*p,t[1]=M*s+x*c+T*f+y*m,t[2]=M*o+x*u+T*d+y*w,t[3]=M*r+x*a+T*v+y*_,M=e[4],x=e[5],T=e[6],y=e[7],t[4]=M*n+x*h+T*l+y*p,t[5]=M*s+x*c+T*f+y*m,t[6]=M*o+x*u+T*d+y*w,t[7]=M*r+x*a+T*v+y*_,M=e[8],x=e[9],T=e[10],y=e[11],t[8]=M*n+x*h+T*l+y*p,t[9]=M*s+x*c+T*f+y*m,t[10]=M*o+x*u+T*d+y*w,t[11]=M*r+x*a+T*v+y*_,M=e[12],x=e[13],T=e[14],y=e[15],t[12]=M*n+x*h+T*l+y*p,t[13]=M*s+x*c+T*f+y*m,t[14]=M*o+x*u+T*d+y*w,t[15]=M*r+x*a+T*v+y*_,t}function n(t,i=[.9,.9,.9,1],e=16640){return(n,s)=>{n.i.o[s]|=1,n.i.h[s]={u:0,l:t,v:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],m:[0,0,0],_:i,M:t.T,g:i,F:e}}}function s(t,i){let e=t.i.P[i],n=t.i.S[i];e.$&&(n.$[0]=e.$[0],n.$[1]=e.$[1],t.i.o[i]|=16),e.C&&(n.C=e.C,t.i.o[i]|=16)}function o(t,i,e){return t[0]=i[0]+e[0],t[1]=i[1]+e[1],t}function r(t,i,e){return t[0]=i[0]*e,t[1]=i[1]*e,t}function h(t,i,e){let n=t.i.I[i],s=t.i.S[i];if(s.$[0]||s.$[1]){X[0]=s.$[0],X[1]=s.$[1];let i=Math.min(1,Math.hypot((h=X)[0],h[1]));(function(t,i,e){let n=i[0],s=i[1];t[0]=e[0]*n+e[2]*s,t[1]=e[1]*n+e[3]*s})(X,X,void 0!==n.X?t.i.I[n.X].Y:n.i),function(t,i){let e=i[0],n=i[1],s=e*e+n*n;s>0&&(s=1/Math.sqrt(s)),t[0]=i[0]*s,t[1]=i[1]*s}(X,X),r(X,X,i*s.A*e),o(n.k,n.k,X),s.$[0]=0,s.$[1]=0}var h;s.C&&(n.C+=s.C*s.D*e,s.C=0)}function c(){return((Y=16807*Y%2147483647)-1)/2147483646}function u(t=0,i=1){return~~(c()*(i-t+1)+t)}function a(t=0,i=1){return c()*(i-t)+t}function l(t,i){return(e,n)=>{e.i.o[n]|=128,e.i.R[n]={u:t,V:i,K:[0,0],U:[0,0]}}}function f(t,i,e){let n=t.i.I[i],s=t.i.R[i];if(1===s.u){let i=-t.j/2/D;n.k[1]<i&&(n.k[1]=i,s.U[1]*=a(-3,-1))}}function d(t,i,e){let n=t.i.I[i],s=t.i.R[i];if(1===s.u){s.U[1]+=-9.81*e,r(s.K,s.K,e),o(s.U,s.U,s.K),r(s.U,s.U,s.V);let c=[0,0];r(c,s.U,e),o(n.k,n.k,c),t.i.o[i]|=16,(h=s.K)[0]=0,h[1]=0}var h}function v(t,i){let e=t.W;t.q.useProgram(e.G),t.q.uniformMatrix4fv(e.L.p,!1,i.p),t.q.activeTexture(33984),t.q.bindTexture(g,t.N["spritesheet.png"]),t.q.uniform1i(e.L.O,0),t.q.bindBuffer(y,t.B),t.q.bufferData(y,t.H,35040),t.q.drawArraysInstanced(e.J,0,4,t.i.o.length)}function p(t,i,e,n){let s=Math.sin(e),o=Math.cos(e);return t[0]=o*n[0],t[1]=s*n[0],t[2]=-s*n[1],t[3]=o*n[1],t[4]=i[0],t[5]=i[1],t}function m(t,i,e){var n,s;if(t.o[i]&=-17,p(e.i,e.k,e.C*b,e.Z),void 0!==e.X&&(function(t,i,e){let n=i[0],s=i[1],o=i[2],r=i[3],h=i[4],c=i[5],u=e[0],a=e[1],l=e[2],f=e[3],d=e[4],v=e[5];t[0]=n*u+o*a,t[1]=s*u+r*a,t[2]=n*l+o*f,t[3]=s*l+r*f,t[4]=n*d+o*v+h,t[5]=s*d+r*v+c}(e.i,t.I[e.X].i,e.i),e.Gyroscope&&((n=A)[0]=(s=e.i)[4],n[1]=s[5],p(e.i,A,e.C*b,e.Z))),function(t,i){let e=i[0],n=i[1],s=i[2],o=i[3],r=i[4],h=i[5],c=e*o-n*s;c&&(c=1/c,t[0]=o*c,t[1]=-n*c,t[2]=-s*c,t[3]=e*c,t[4]=(s*h-o*r)*c,t[5]=(n*r-e*h)*c)}(e.Y,e.i),8&t.o[i]){let e=t.tt[i];for(let n=0;n<e.tt.length;n++){let s=e.tt[n];if(256&t.o[s]){let e=t.I[s];e.X=i,m(t,s,e)}}}}function w(t,i,e,n){let s=~~(6*t),o=6*t-s,r=e*(1-i),h=e*(1-o*i),c=e*(1-(1-o)*i);switch(s%6){case 0:return[e,c,r,n];case 1:return[h,e,r,n];case 2:return[r,e,c,n];case 3:return[r,h,e,n];case 4:return[c,r,e,n];default:return[e,r,h,n]}}function _(t,i,e=[1,1,1,1]){return(n,s)=>{let o=s*k;n.H[o+6]=0,n.H[o+7]=1,n.H[o+8]=e[0],n.H[o+9]=e[1],n.H[o+10]=e[2],n.H[o+11]=e[3],n.H[o+12]=i[0],n.H[o+13]=t[1]-i[1]-1,n.H[o+14]=t[0],n.H[o+15]=t[1],n.i.o[s]|=64,n.i.it[s]={et:n.H.subarray(o+6,o+8),nt:n.H.subarray(o+8,o+12),st:n.H.subarray(o+12,o+16)}}}function M(t){return(i,e)=>{i.H[e*k+6]=t}}function x(t=[0,0],i=0,e=[1,1]){return(n,s)=>{n.i.o[s]|=272,n.i.I[s]={i:n.H.subarray(s*k,s*k+6),Y:[1,0,0,1,0,0],k:t,C:i,Z:e,Gyroscope:!1}}}async function T(t,i){let e=await(n="../textures/"+i+".webp",new Promise((t=>{let i=new Image;i.src=n,i.onload=()=>t(i)})));var n;t.N[i]=function(t,i){let e=t.createTexture();return t.bindTexture(g,e),t.texImage2D(g,0,6408,6408,5121,i),t.generateMipmap(g),t.texParameteri(g,10241,9984),t.texParameteri(g,10240,9728),t.texParameteri(g,10242,10497),t.texParameteri(g,10243,10497),e}(t.q,e)}var y=34962,g=3553,F=5126,P=document.getElementById("update"),S=document.getElementById("delta"),$=document.getElementById("fps"),C=1/60,I=class extends class{constructor(t=1e4){this.o=[],this.ot=[],this.rt=t}t(){return this.ot.length>0?this.ot.pop():this.o.push(0)-1}ht(t){this.o[t]=0,this.ot.push(t)}}{constructor(){super(...arguments),this.h=[],this.P=[],this.ct=[],this.tt=[],this.S=[],this.it=[],this.R=[],this.I=[]}},X=[0,0],Y=1,b=Math.PI/180,A=[0,0],k=16,z=4*k,D=32,R=Float32Array.from([-.5,-.5,0,0,0,.5,-.5,0,1,0,-.5,.5,0,0,1,.5,.5,0,1,1]),V=new class extends class extends class{constructor(){this.ut=0,this.lt=0,this.ft=window.innerWidth,this.j=window.innerHeight,this.dt=!0,this.vt={MouseX:0,MouseY:0},this.wt={MouseX:0,MouseY:0},this._t={Mouse:0,Mouse0:0,Mouse1:0,Mouse2:0,Touch0:0,Touch1:0},this.Mt={},this.xt=document.querySelector("main"),document.addEventListener("visibilitychange",(()=>document.hidden?this.Tt():this.yt())),this.xt.addEventListener("contextmenu",(t=>t.preventDefault())),this.xt.addEventListener("mousedown",(t=>{this.vt["Mouse"+t.button]=1,this.wt["Mouse"+t.button]=1})),this.xt.addEventListener("mouseup",(t=>{this.vt["Mouse"+t.button]=0,this.wt["Mouse"+t.button]=-1})),this.xt.addEventListener("mousemove",(t=>{this.vt.MouseX=t.clientX,this.vt.MouseY=t.clientY,this.wt.MouseX=t.movementX,this.wt.MouseY=t.movementY})),this.xt.addEventListener("wheel",(t=>{t.preventDefault(),this.wt.WheelY=t.deltaY})),this.xt.addEventListener("touchstart",(t=>{t.target===this.xt&&t.preventDefault(),1===t.touches.length&&(this.Mt={});for(let i=0;i<t.touches.length;i++)this.Mt[t.touches[i].identifier]=i;for(let i=0;i<t.changedTouches.length;i++){let e=t.changedTouches[i],n=this.Mt[e.identifier];this.vt["Touch"+n]=1,this.vt[`Touch${n}X`]=e.clientX,this.vt[`Touch${n}Y`]=e.clientY,this.wt["Touch"+n]=1,this.wt[`Touch${n}X`]=0,this.wt[`Touch${n}Y`]=0}})),this.xt.addEventListener("touchmove",(t=>{t.target===this.xt&&t.preventDefault();for(let i=0;i<t.changedTouches.length;i++){let e=t.changedTouches[i],n=this.Mt[e.identifier];this.wt[`Touch${n}X`]=e.clientX-this.vt[`Touch${n}X`],this.wt[`Touch${n}Y`]=e.clientY-this.vt[`Touch${n}Y`],this.vt[`Touch${n}X`]=e.clientX,this.vt[`Touch${n}Y`]=e.clientY}})),this.xt.addEventListener("touchend",(t=>{t.target===this.xt&&t.preventDefault();for(let i=0;i<t.changedTouches.length;i++){let e=this.Mt[t.changedTouches[i].identifier];this.vt["Touch"+e]=0,this.wt["Touch"+e]=-1}})),this.xt.addEventListener("touchcancel",(t=>{for(let i=0;i<t.changedTouches.length;i++){let e=this.Mt[t.changedTouches[i].identifier];this.vt["Touch"+e]=0,this.wt["Touch"+e]=-1}})),window.addEventListener("keydown",(t=>{t.repeat||(this.vt[t.code]=1,this.wt[t.code]=1)})),window.addEventListener("keyup",(t=>{this.vt[t.code]=0,this.wt[t.code]=-1}))}yt(){let t=0,i=performance.now(),e=n=>{let s=(n-i)/1e3;for(i=n,this.ut=requestAnimationFrame(e),this.gt(s),t+=s;t>=C;)t-=C,this.Ft(C);this.Pt(s),this.St(s)};this.Tt(),e(i)}Tt(){cancelAnimationFrame(this.ut),this.ut=0}gt(t){this.lt=performance.now();let i=Math.abs(this.wt.MouseX)+Math.abs(this.wt.MouseY);this._t.Mouse+=i,1===this.vt.Mouse0&&(this._t.Mouse0+=i),1===this.vt.Mouse1&&(this._t.Mouse1+=i),1===this.vt.Mouse2&&(this._t.Mouse2+=i),1===this.vt.Touch0&&(this._t.Touch0+=Math.abs(this.wt.Touch0X)+Math.abs(this.wt.Touch0Y)),1===this.vt.Touch1&&(this._t.Touch1+=Math.abs(this.wt.Touch1X)+Math.abs(this.wt.Touch1Y))}Ft(t){}Pt(t){}St(t){this.dt=!1,-1===this.wt.Mouse0&&(this._t.Mouse0=0),-1===this.wt.Mouse1&&(this._t.Mouse1=0),-1===this.wt.Mouse2&&(this._t.Mouse2=0),-1===this.wt.Touch0&&(this._t.Touch0=0),-1===this.wt.Touch1&&(this._t.Touch1=0);for(let t in this.wt)this.wt[t]=0;let i=performance.now()-this.lt;P&&(P.textContent=i.toFixed(1)),S&&(S.textContent=(1e3*t).toFixed(1)),$&&($.textContent=(1/t).toFixed())}}{constructor(){super(),this.$t=document.querySelector("#billboard"),this.Ct=this.$t.getContext("2d"),this.It=document.querySelector("#scene"),this.q=this.It.getContext("webgl2"),this.Audio=new AudioContext,this.Xt=[],this.Yt={},this.q.enable(2929),this.q.enable(2884),this.q.blendFunc(770,771)}gt(t){super.gt(t),this.Xt=[]}}{constructor(){super(),this.i=new I(50001),this.W=function(t){let e=function(t,e,n){let s=t.createProgram();return t.attachShader(s,i(t,35633,"#version 300 es\n\nuniform mat4 pv;\n\n\nin vec4 attr_position;\nin vec2 attr_texcoord;\n\n\nin vec4 attr_rotation; \nin vec4 attr_translation; \nin vec4 attr_color;\nin vec4 attr_sprite;\n\nout vec2 vert_texcoord;\nout vec4 vert_color;\nout vec4 vert_sprite;\n\nvoid main() {\nmat4 world = mat4(\nattr_rotation.xy, 0, 0,\nattr_rotation.zw, 0, 0,\n0, 0, 1, 0,\nattr_translation.xyz, 1\n);\n\nvec4 world_position = world * attr_position;\ngl_Position = pv * world_position;\nif (attr_translation.w == 0.0) {\ngl_Position.z = 2.0;\n}\n\nvert_texcoord = (attr_sprite.xy + attr_texcoord) / attr_sprite.zw;\nvert_color = attr_color;\n}\n")),t.attachShader(s,i(t,35632,"#version 300 es\n\nprecision mediump float;\n\nuniform sampler2D sheet;\n\nin vec2 vert_texcoord;\nin vec4 vert_color;\n\nout vec4 frag_color;\n\nvoid main() {\nfrag_color = vert_color * texture(sheet, vert_texcoord);\nif (frag_color.a == 0.0) {\ndiscard;\n}\n}\n")),t.linkProgram(s),s}(t);return{J:5,G:e,L:{p:t.getUniformLocation(e,"pv"),i:t.getUniformLocation(e,"world"),O:t.getUniformLocation(e,"sheet"),bt:t.getAttribLocation(e,"attr_position"),At:t.getAttribLocation(e,"attr_texcoord"),kt:t.getAttribLocation(e,"attr_rotation"),zt:t.getAttribLocation(e,"attr_translation"),Dt:t.getAttribLocation(e,"attr_color"),Rt:t.getAttribLocation(e,"attr_sprite")}}}(this.q),this.N={},this.H=new Float32Array(this.i.rt*k),this.B=this.q.createBuffer(),this.q.pixelStorei(37440,!0);let t=this.W,e=this.q.createBuffer();this.q.bindBuffer(y,e),this.q.bufferData(y,R,35044),this.q.enableVertexAttribArray(t.L.bt),this.q.vertexAttribPointer(t.L.bt,3,F,!1,20,0),this.q.enableVertexAttribArray(t.L.At),this.q.vertexAttribPointer(t.L.At,2,F,!1,20,12),this.q.bindBuffer(y,this.B),this.q.bufferData(y,this.i.rt*z,35040),this.q.enableVertexAttribArray(t.L.kt),this.q.vertexAttribDivisor(t.L.kt,1),this.q.vertexAttribPointer(t.L.kt,4,F,!1,z,0),this.q.enableVertexAttribArray(t.L.zt),this.q.vertexAttribDivisor(t.L.zt,1),this.q.vertexAttribPointer(t.L.zt,4,F,!1,z,16),this.q.enableVertexAttribArray(t.L.Dt),this.q.vertexAttribDivisor(t.L.Dt,1),this.q.vertexAttribPointer(t.L.Dt,4,F,!1,z,32),this.q.enableVertexAttribArray(t.L.Rt),this.q.vertexAttribDivisor(t.L.Rt,1),this.q.vertexAttribPointer(t.L.Rt,4,F,!1,z,48)}Pt(t){!function(t,i){if(t.ft==window.innerWidth&&t.j==window.innerHeight||(t.dt=!0),t.dt){t.ft=t.It.width=t.$t.width=window.innerWidth,t.j=t.It.height=t.$t.height=window.innerHeight;for(let i=0;i<t.i.o.length;i++)if(1==(1&t.i.o[i])){let s=t.i.h[i];if(0==s.u&&1==s.l.u){s.l.Vt=t.j/D/2,function(t,i,e,n,s,o,r){let h=1/(s-e),c=1/(n-i),u=1/(o-r);t[0]=-2*h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(s+e)*h,t[13]=(i+n)*c,t[14]=(r+o)*u,t[15]=1}((e=s.l).l,e.Vt,e.Vt*(n=t.ft/t.j),-e.Vt,-e.Vt*n,e.Et,e.T),function(t,i){let e=i[0],n=i[1],s=i[2],o=i[3],r=i[4],h=i[5],c=i[6],u=i[7],a=i[8],l=i[9],f=i[10],d=i[11],v=i[12],p=i[13],m=i[14],w=i[15],_=e*h-n*r,M=e*c-s*r,x=e*u-o*r,T=n*c-s*h,y=n*u-o*h,g=s*u-o*c,F=a*p-l*v,P=a*m-f*v,S=a*w-d*v,$=l*m-f*p,C=l*w-d*p,I=f*w-d*m,X=_*I-M*C+x*$+T*S-y*P+g*F;X&&(X=1/X,t[0]=(h*I-c*C+u*$)*X,t[1]=(s*C-n*I-o*$)*X,t[2]=(p*g-m*y+w*T)*X,t[3]=(f*y-l*g-d*T)*X,t[4]=(c*S-r*I-u*P)*X,t[5]=(e*I-s*S+o*P)*X,t[6]=(m*x-v*g-w*M)*X,t[7]=(a*g-f*x+d*M)*X,t[8]=(r*C-h*S+u*F)*X,t[9]=(n*S-e*C-o*F)*X,t[10]=(v*y-p*x+w*_)*X,t[11]=(l*x-a*y-d*_)*X,t[12]=(h*P-r*$-c*F)*X,t[13]=(e*$-n*P+s*F)*X,t[14]=(p*M-v*T-m*_)*X,t[15]=(a*T-l*M+f*_)*X)}(e.Kt,e.l);break}}}var e,n}(this),function(t,i){for(let i=0;i<t.i.o.length;i++)if(257==(257&t.i.o[i])){let n=t.i.h[i];if(0!==n.u)throw Error("Only canvas cameras are supported.");let s=n.l,o=t.i.I[i];n.v[0]=o.Y[0],n.v[1]=o.Y[1],n.v[4]=o.Y[2],n.v[5]=o.Y[3],n.v[12]=o.Y[4],n.v[13]=o.Y[5],n.v[14]=-2,e(n.p,s.l,n.v),n.m[0]=o.i[4],n.m[1]=o.i[5],n.m[2]=2,t.Xt.push(i)}}(this),function(t,i){for(let i=0;i<t.i.o.length;i++)34==(34&t.i.o[i])&&s(t,i)}(this),function(t,i){for(let e=0;e<t.i.o.length;e++)304==(304&t.i.o[e])&&h(t,e,i)}(this,t),function(t,i){for(let e=0;e<t.i.o.length;e++)384==(384&t.i.o[e])&&d(t,e,i)}(this,t),function(t,i){for(let i=0;i<t.i.o.length;i++)272==(272&t.i.o[i])&&m(t.i,i,t.i.I[i])}(this),function(t,i){for(let i=0;i<t.i.o.length;i++)384==(384&t.i.o[i])&&f(t,i)}(this),function(t,i){for(let i=0;i<t.i.o.length;i++){let e=i*k+7;64&t.i.o[i]?0==t.H[e]&&(t.H[e]=1):1==t.H[e]&&(t.H[e]=0)}for(let i of t.Xt){let e=t.i.h[i];0===e.u&&(t.q.bindFramebuffer(36160,null),t.q.viewport(0,0,t.ft,t.j),t.q.clearColor(...e.g),t.q.clear(e.F),v(t,e))}}(this)}};window.game=V,Promise.all([T(V,"checker1.png"),T(V,"spritesheet.png")]).then((()=>{!function(i){i.i=new I(50001),i.dt=!0,t(i,[x([0,0]),n({u:1,Vt:5,Et:1,T:3,l:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Kt:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]})]);for(let e=0;e<5e3;e++)t(i,[x([a(-10,10),a(9,10)],0),_([8,8],[u(0,1),0],w(a(.1,.2),.5,1,1)),M(1-e/5e3),l(1,a(.98,.99))])}(V),V.yt()}))})();
</script>
